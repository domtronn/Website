function Star(a,b){this.x=a,this.y=b,this.r=Math.random()}function Layer(a,b){this.stars=[],this.depth=b;for(var c=0;a>c;c++){var d=Math.random()*canvas.width*2-canvas.width/2,e=Math.random()*canvas.height*2-canvas.height/2;this.stars.push(new Star(d,e))}}function StarField(a,b){a=a||this.COUNT,b=b||this.LAYERS,this.layers=[];for(var c=1;b>=c;c++)this.layers.push(new Layer(a*c,c))}function newStarField(){sf&&sf.stop(),sf=new StarField,sf.reset(),sf.render()}function toggleControls(){controls.className.indexOf("slideLeft")<0?(controls.classList.add("slideLeft"),controls.classList.add("rotateRight")):(controls.classList.remove("slideLeft"),controls.classList.remove("rotateRight"))}Star.prototype.move=function(a,b){this.x+=a,this.y+=b},Star.prototype.draw=function(){ctx.beginPath(),ctx.fillStyle="white",ctx.arc(this.x,this.y,this.r+this.MIN_RADIUS,0,2*Math.PI),ctx.fill()},Layer.prototype.getParallaxAmount=function(){return this.PARALLAX/this.depth},Layer.prototype.remove=function(a){var b=this.stars.indexOf(a);this.stars.splice(b,1)},StarField.prototype.reset=function(){ctx.beginPath(),ctx.fillStyle="black",ctx.fillRect(0,0,canvas.width,canvas.height)},StarField.prototype.forAllStarsCall=function(a){this.layers.forEach(function(b){b.stars.forEach(function(c){a(c,b)})})},StarField.prototype.render=function(){this.forAllStarsCall(function(a){a.draw()})},StarField.prototype.move=function(a,b){this.forAllStarsCall(function(c,d){c.move(a*d.getParallaxAmount(),b*d.getParallaxAmount()),c.draw()})},StarField.prototype.zoom=function(a){var b,c,d=this;a=a||1,this.stop(),this.intervalId=setInterval(function(){d.reset(),d.forAllStarsCall(function(e,f){b=(e.x-canvas.width/2)*d.ZOOM_SPEED*.1*f.getParallaxAmount()*a,c=(e.y-canvas.height/2)*d.ZOOM_SPEED*.1*f.getParallaxAmount()*a,e.move(b,c),e.draw()})},10)},StarField.prototype.calculateDelta=function(a){var b=this.SHIFT_DELTA,c=a+Math.round(Math.random()*b-b/2);return Math.min(Math.max(c,-b),b)},StarField.prototype.stop=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)},StarField.prototype.shift=function(){var a=this,b=0,c=0;this.stop(),this.intervalId=setInterval(function(){b=a.calculateDelta(b),c=a.calculateDelta(c),a.reset(),a.self.move(b,c)},50)},Layer.prototype.PARALLAX=1,Star.prototype.MIN_RADIUS=.3,StarField.prototype.ZOOM_SPEED=1,StarField.prototype.SHIFT_DELTA=20,StarField.prototype.COUNT=20,StarField.prototype.LAYERS=10;var canvas,ctx,sf;canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),ctx.canvas.width=window.innerWidth,ctx.canvas.height=window.innerHeight,newStarField();var s5=new Slider("#starsSlider",{min:1,max:200,step:1,value:20});s5.on("change",function(a){StarField.prototype.COUNT=a.newValue,newStarField()});var s6=new Slider("#layersSlider",{min:1,max:20,step:1,value:10});s6.on("change",function(a){StarField.prototype.LAYERS=a.newValue,newStarField()});var s1=new Slider("#parallaxSlider",{min:.1,max:1,step:.05});s1.on("change",function(a){Layer.prototype.PARALLAX=a.newValue});var s2=new Slider("#sizeSlider",{min:.1,max:1,step:.05,value:.3});s2.on("change",function(a){Star.prototype.MIN_RADIUS=a.newValue,sf.reset(),sf.render()});var s3=new Slider("#zoomSlider",{min:-1,max:1,step:.01,value:1});s3.on("change",function(a){StarField.prototype.ZOOM_SPEED=a.newValue});var s4=new Slider("#shiftSlider",{min:0,max:50,step:1,value:10});s4.on("change",function(a){StarField.prototype.SHIFT_DELTA=a.newValue}),canvas.onmousemove=function(a){sf.reset(),sf.move(a.movementX,a.movementY)},document.addEventListener("keydown",function(a){83===a.keyCode&&(sf.intervalId?sf.stop():sf.shift()),90===a.keyCode&&(sf.intervalId?sf.stop():sf.zoom()),80===a.keyCode&&sf.stop(),82===a.keyCode&&newStarField()});var controls=document.getElementById("controls");document.getElementById("control-nav").onclick=function(){toggleControls()},document.addEventListener("keydown",function(a){67===a.keyCode&&toggleControls()});